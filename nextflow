#!/usr/bin/env bash
set -euo pipefail

# Change to the repo root (assuming this script lives in bin/)
script_dir="$(cd "$(dirname "${BASH_SOURCE[0]}")" && pwd)"
repo_root="$(cd "${script_dir}" && pwd)"
cd "$repo_root"

# Auto-build custom module images (if any)
if [ -x "${script_dir}/bin/build_images.sh" ]; then
  echo "üî® Building custom module images..."
  "${script_dir}/bin/build_images.sh"
else
  echo "‚ö†Ô∏è  No build_images.sh found or not executable; skipping image build"
fi

# Delegate to Nextflow
# Pass all arguments through; users can call 'run .' or other commands
echo "Launching Nextflow: nextflow $*"
exec nextflow "$@"